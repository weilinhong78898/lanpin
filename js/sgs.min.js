var app=angular.module("sgs",["ng","ngRoute"]);app.config(function(a){a.when("/start",{templateUrl:"tpl/start.html",controller:"startCtrl"}).when("/main",{templateUrl:"tpl/main.html",controller:"mainCtrl"}).when("/detail",{templateUrl:"tpl/detail.html",controller:"detailCtrl"}).when("/detail/:id",{templateUrl:"tpl/detail.html",controller:"detailCtrl"}).when("/order",{templateUrl:"tpl/order.html",controller:"orderCtrl"}).when("/order/:id",{templateUrl:"tpl/order.html",controller:"orderCtrl"}).when("/myOrder",{templateUrl:"tpl/myOrder.html",controller:"myOrderCtrl"}).when("/myOrder/:id",{templateUrl:"tpl/myOrder.html",controller:"myOrderCtrl"}).otherwise({redirectTo:"/start"})});app.controller("sgsCtrl",["$scope","$location","$interval",function(a,c,b){a.jump=function(d){c.path(d)};a.bgList=["bg.jpg","bg2.jpg"];a.index=0;b(function(){a.index++;if(a.index>1){a.index=0}$("body").css("background","url(img/"+a.bgList[a.index]+") no-repeat").fadeIn(2000,"linear")},8000)}]);app.controller("startCtrl",["$scope",function(a){}]);app.controller("mainCtrl",["$scope","$http",function(a,b){a.hasMore=true;b.get("data/hero_getbypage.php?start=0").success(function(c){console.log(c);a.heroList=c});a.loadMore=function(){b.get("data/hero_getbypage.php?start="+a.heroList.length).success(function(c){a.heroList=a.heroList.concat(c);if(c.length<8){a.hasMore=false}})};a.$watch("kw",function(){if(a.kw){b.get("data/hero_getbykw.php?kw="+a.kw).success(function(c){a.heroList=c})}})}]);app.controller("detailCtrl",["$scope","$routeParams","$http",function(b,c,d){var a=c.id;d.get("data/hero_getbyid.php?id="+a).success(function(e){console.log(e);b.hero=e[0]})}]);app.controller("orderCtrl",["$scope","$routeParams","$http",function(b,c,d){var a=c.id;b.order={hid:a};b.submitOrder=function(){var e=jQuery.param(b.order);d.get("data/order_add.php?"+e).success(function(f){console.log(f);if(f[0].msg=="succ"){sessionStorage.setItem("phone",b.order.phone);b.succMsg="下单成功，订单编号为"+f[0].oid}else{b.errMsg="下单失败!"}})}}]);app.controller("myOrderCtrl",["$scope","$http",function(a,b){b.get("data/order_getbyphone.php?phone="+sessionStorage.getItem("phone")).success(function(c){console.log(c);a.orderList=c})}]);